<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>rock paper scissors</title>
  <link rel="stylesheet" href="styles.css">
  <script src="script.js"></script>
</head>
<body>
  <h1>WELCOME TO ROCK PAPER SCISSORS</h1>

  <div class="game">
    <p class="html-text">what do you chose</p>

    <button class="button" onclick="move = plyrMove('rock');
      setOuput(move)"> <!--we call a func and pass aparam -->
     <img src="img/rock-emoji.png" alt="rock-img">
    </button>

    <button class="button" onclick="move = plyrMove('paper');
      setOuput(move)">
     <img src="img/paper-emoji.png" alt="paper-img">
    </button>

    <button class="button" onclick="move = plyrMove('scissors');
      setOuput(move)">
     <img src="img/scissors-emoji.png" alt="scissors-img">
    </button>

    <p class="js-result">result</p>
    <p class="js-moves">moves</p>
    <p class="js-scores">scores</p>


    <button class="reset-btn" onclick="
      score.wins = 0;
      score.lose = 0;
      score.ties = 0;
      localStorage.removeItem(key);
      document.querySelector('.js-scores').innerHTML = JSON.stringify(score);
    ">
      Reset Score <!--resets the object 'score' to default and clears local storage-->
    </button>
  </div>

  <style>
   body{
    background-color: black;
    color: white;
    /* box-sizing: border-box; */
   }
  .game{
    font-size: 20px;
    align-content: center;
    /* border: solid; */
    margin: 50px;
   }
  .reset-btn{
    color: white;
    background-color: rgb(146, 144, 15);
    border: 2px solid white;
    height: 50px;
    width: 200px;
    font-size: 25px;
    border-radius: 15px;

  }
  .button{
    background-color: transparent;
    border: 5px solid white;
    margin: 5px;
    padding: 25px;
    border-radius: 80px;
    cursor: pointer;
  }
  img{
    width: 100px;
    height: 100px;
  }
  .img{
    width: 50px;
    height: 50px;
  }

  </style>  


  <script>

    const score = {
      wins : 0,
      lose : 0,
      ties : 0
    };

    const key = 'scoreObj'// Define a key to identify the object

    function saveToLocalStorage(core) {
          console.log('start of func')
          console.log(`core=${JSON.stringify(core)}`)


      const existingScore = JSON.parse(localStorage.getItem(key));//returns a truthy or falsy val

          console.log(`exScr=${JSON.stringify(existingScore)}`);

      if (existingScore) {
        //...remove init data in localstorge

        if (core.wins > existingScore.wins || core.lose > existingScore.lose || core.ties > existingScore.ties) {
        //...Update values in existing object
        existingScore.wins = core.wins;
        existingScore.lose = core.lose;
        existingScore.ties = core.ties;

        //...update localstorage as needed
        localStorage.setItem(key, JSON.stringify(existingScore));}

            console.log('localStorage' + localStorage.getItem(key));

        console.log('reached 1st if')

      } else {
        //...Create new object if it doesn't exist
        localStorage.setItem(key, JSON.stringify(core));

        console.log('reached 2nd if')
      }
      //...sets default 
      scores = existingScore || core;
      console.log(scores)

      return scores
 
    }


    // func to calc results, it takes a par 
    function plyrMove(playerMove) {
      console.log('start of on click');
      
       //...call compMove n save its retn val
      computerMove = compMove();

      htmlResult = document.querySelector('.js-result');

      htmlScore = document.querySelector('.js-scores');

      // if block in func to compare comp and plyr move
      if (playerMove ==='rock') {
        if (computerMove ==='rock') {
          score.ties +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'its a tie';
          htmlScore.innerHTML = JSON.stringify(scores)

        } else if (computerMove === 'paper') {
          score.lose +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'you lose';
          htmlScore.innerHTML = JSON.stringify(scores);

        } else {
          score.wins +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'you won';
          htmlScore.innerHTML = JSON.stringify(scores);
        }

      } else if (playerMove === 'paper') {
        if (computerMove ==='rock') {
          score.wins +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML ='you won';
          htmlScore.innerHTML = JSON.stringify(scores);

        } else if (computerMove === 'paper') {
          score.ties +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'its a tie';
          htmlScore.innerHTML = JSON.stringify(scores);

        } else {
          score.lose +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'you lose';
          htmlScore.innerHTML = JSON.stringify(scores);
        }

      } else if (playerMove === 'scissors') {
        if (computerMove === 'rock') {
          score.lose +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'you lose';
          htmlScore.innerHTML = JSON.stringify(scores);

        } else if (computerMove === 'paper') {
          score.wins +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'you won';
          htmlScore.innerHTML = JSON.stringify(scores);

        } else {
          score.ties +=1;
          scores = saveToLocalStorage(score);
          htmlResult.innerHTML = 'its a tie';
          htmlScore.innerHTML = JSON.stringify(scores);

        }
      }


      // updates img src and rtrns templt string with img elem
      return `plyr = <img class="img" src="img/${playerMove}-emoji.png" alt="${playerMove}"> <img class="img" src="img/${computerMove}-emoji.png" alt="${compMove}"> = comp`;
    }

    //...updates scores element
    function setOuput(move, ) {
      document.querySelector('.js-moves').innerHTML = move;

    }

    // a func to generate computer move
    function compMove() {
      const randomNumber = Math.random();
      if (0 < randomNumber && randomNumber <= (1/3)) {
        return 'rock';
      } else if ((1/3) < randomNumber && randomNumber <= (2/3)) {
        return 'paper';
      } else if ((2/3) < randomNumber && randomNumber <(3/3)) {
        return 'scissors';
      }
    }

  </script>
  
</body>
</html>